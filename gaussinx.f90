!ガウスルジャンドル計算
program main
implicit none
!メインプログラムの処理
integer i
real(8) :: total,finaltotal
real(8) :: a=0.d0
real(8) :: b=1.d0
real(8) :: xx=5.d0
real(8)::speed=0.d0
real(8) :: w(100,100),node(100,100)
w(100,1)=7.34634490505671730406320658330336390670473562483E-4
    w(100,2)=0.001709392653518105239529358371491195243731385491463d0
    w(100,3)=0.002683925371553482419439590429001120081931114951d0
    w(100,4)=0.00365596120132637518234245872752519569920656740515d0
    w(100,5)=0.0046244500634221193510957890829784766503524952949d0
    w(100,6)=0.00558842800386551515721194634843921073131869400808d0
    w(100,7)=0.00654694845084532276415210333149526369993836336648d0
    w(100,8)=0.00749907325546471157882874401639778316358347894815d0
    w(100,9)=0.0084438714696689714026208349023010019346444598841d0
    w(100,10)=0.0093804196536944579514182376608121187307870432387d0
    w(100,11)=0.0103078025748689695857821017278353779760583438414d0
    w(100,12)=0.0112251140231859771172215733663335847772264195644d0
    w(100,13)=0.01213145766297949740774479244874817073696312331126d0
    w(100,14)=0.01302594789297154228555858375890179013496473584175d0
    w(100,15)=0.01390771070371877268795414910800463779518081214312d0
    w(100,16)=0.0147758845274413017688799875203542571693887431146d0
    w(100,17)=0.01562962107754600272393686595379192555246997980994d0
    w(100,18)=0.0164680861761452126431049800882107808211676616038d0
    w(100,19)=0.01729046056832358243934419836674167481162350856517d0
    w(100,20)=0.01809594072212811666439075142049303134757874495839d0
    w(100,21)=0.01888373961337490455294116588154323429711127634742d0
    w(100,22)=0.019653087494435305865381470245444065555269599491251d0
    w(100,23)=0.02040323264620943276683885165758377060570969930262d0
    w(100,24)=0.02113344211252764154267230044096968163532972887451d0
    w(100,25)=0.0218430024162473863139537413043980247653489998232d0
    w(100,26)=0.02253122025633627270179697093167396234015893534871d0
    w(100,27)=0.02319742318525412162248885418272728845115448573609d0
    w(100,28)=0.0238409602659682059625604119022834321447074490926d0
    w(100,29)=0.024461202707957052719975023349772890646295732397804d0
    w(100,30)=0.02505754448157958970376422562092326422383855852793d0
    w(100,31)=0.02562940291020811607564200986215087092697767002027d0
    w(100,32)=0.02617621923954567634230874175730188501127513119069d0
    w(100,33)=0.02669745918357096266038466418633635063465575039001d0
    w(100,34)=0.027192613446576880136491567802170692266987896012d0
    w(100,35)=0.02766119822079238829420415587042645529240035866422d0
    w(100,36)=0.02810275565910117331764833018699455045141809940021d0
    w(100,37)=0.028516854322395097990936762864457873259842725484d0
    w(100,38)=0.028903089601125203134876228134515265315607868055261d0
    w(100,39)=0.02926108411063827662011902349564095444308419504535d0
    w(100,40)=0.0295904880599126425117545106788365851728062850714d0
    w(100,41)=0.029890979593332830916836806668595827658091414260799d0
    w(100,42)=0.0301622651051691449190686816104792326571023257827d0
    w(100,43)=0.030404079526454820016507859818825176605607248310117d0
    w(100,44)=0.0306161865839804484964594432620531928530860237891d0
    w(100,45)=0.03079837903115259042771390303055976009497083447037d0
    w(100,46)=0.03095047885049098823406346347074792738298717776694d0
    w(100,47)=0.031072337427566516587810170242918034845915436348d0
    w(100,48)=0.0311638356962099067838183212171866533438363686839d0
    w(100,49)=0.03122488425484935773237649864809813488180274068218d0
    w(100,50)=0.03125542345386335694764247438619802878783383672609d0
    w(100,51)=0.03125542345386335694764247438619802878783383672609d0
    w(100,52)=0.0312248842548493577323764986480981348818027406822d0
    w(100,53)=0.03116383569620990678381832121718665334383636868393d0
    w(100,54)=0.03107233742756651658781017024291803484591543634796d0
    w(100,55)=0.0309504788504909882340634634707479273829871777669d0
    w(100,56)=0.0307983790311525904277139030305597600949708344704d0
    w(100,57)=0.03061618658398044849645944326205319285308602378906d0
    w(100,58)=0.0304040795264548200165078598188251766056072483101d0
    w(100,59)=0.03016226510516914491906868161047923265710232578271d0
    w(100,60)=0.0298909795933328309168368066685958276580914142608d0
    w(100,61)=0.0295904880599126425117545106788365851728062850714d0
    w(100,62)=0.0292610841106382766201190234956409544430841950453d0
    w(100,63)=0.02890308960112520313487622813451526531560786805526d0
    w(100,64)=0.02851685432239509799093676286445787325984272548397d0
    w(100,65)=0.0281027556591011733176483301869945504514180994002d0
    w(100,66)=0.02766119822079238829420415587042645529240035866422d0
    w(100,67)=0.027192613446576880136491567802170692266987896012d0
    w(100,68)=0.02669745918357096266038466418633635063465575039001d0
    w(100,69)=0.0261762192395456763423087417573018850112751311907d0
    w(100,70)=0.02562940291020811607564200986215087092697767002027d0
    w(100,71)=0.02505754448157958970376422562092326422383855852793d0
    w(100,72)=0.0244612027079570527199750233497728906462957323978d0
    w(100,73)=0.0238409602659682059625604119022834321447074490926d0
    w(100,74)=0.0231974231852541216224888541827272884511544857361d0
    w(100,75)=0.0225312202563362727017969709316739623401589353487d0
    w(100,76)=0.0218430024162473863139537413043980247653489998232d0
    w(100,77)=0.0211334421125276415426723004409696816353297288745d0
    w(100,78)=0.02040323264620943276683885165758377060570969930262d0
    w(100,79)=0.01965308749443530586538147024544406555526959949125d0
    w(100,80)=0.01888373961337490455294116588154323429711127634742d0
    w(100,81)=0.01809594072212811666439075142049303134757874495839d0
    w(100,82)=0.0172904605683235824393441983667416748116235085652d0
    w(100,83)=0.0164680861761452126431049800882107808211676616038d0
    w(100,84)=0.0156296210775460027239368659537919255524699798099d0
    w(100,85)=0.0147758845274413017688799875203542571693887431146d0
    w(100,86)=0.01390771070371877268795414910800463779518081214312d0
    w(100,87)=0.01302594789297154228555858375890179013496473584175d0
    w(100,88)=0.01213145766297949740774479244874817073696312331126d0
    w(100,89)=0.01122511402318597711722157336633358477722641956438d0
    w(100,90)=0.0103078025748689695857821017278353779760583438414d0
    w(100,91)=0.00938041965369445795141823766081211873078704323867d0
    w(100,92)=0.0084438714696689714026208349023010019346444598841d0
    w(100,93)=0.0074990732554647115788287440163977831635834789481d0
    w(100,94)=0.00654694845084532276415210333149526369993836336648d0
    w(100,95)=0.0055884280038655151572119463484392107313186940081d0
    w(100,96)=0.00462445006342211935109578908297847665035249529489d0
    w(100,97)=0.00365596120132637518234245872752519569920656740515d0
    w(100,98)=0.002683925371553482419439590429001120081931114951d0
    w(100,99)=0.00170939265351810523952935837149119524373138549146d0
    w(100,100)=7.34634490505671730406320658330336390670473562483E-4
    node(100,1)=-0.9997137267734412336782284693423006767183495273084d0
    node(100,2)=-0.99849195063959581840016335918634916230485485042057d0
    node(100,3)=-0.99629513473312514918613173224113103543643128814043d0
    node(100,4)=-0.99312493703744345965200989284878347073177145886652d0
    node(100,5)=-0.98898439524299174800441874580773663183933363710695d0
    node(100,6)=-0.9838775407060570154961001555110081673443670168508d0
    node(100,7)=-0.97780935848691828855378108842920192863523449426625d0
    node(100,8)=-0.97078577576370633193089785789750538855055719947821d0
    node(100,9)=-0.96281365425581552729365932603016638643733150673041d0
    node(100,10)=-0.95390078292549174284933693089435764464522145101467d0
    node(100,11)=-0.9440558701362559779627747064152187467397203733821d0
    node(100,12)=-0.93328853504307954592433366813086250408354607429702d0
    node(100,13)=-0.9216092981453339526669513284819874591245827977322d0
    node(100,14)=-0.90902957098252969046712633778914606444327728958459d0
    node(100,15)=-0.89556164497072698669852102243022776984818176899772d0
    node(100,16)=-0.88121867938501841557331682542780558244549441102126d0
    node(100,17)=-0.86601468849716462341073996967624296638031483930559d0
    node(100,18)=-0.84996452787959128429336259142010465407379077950067d0
    node(100,19)=-0.83308387988840082354291583384475567990749483030996d0
    node(100,20)=-0.8153892383391762543939887586492580053825503765137d0
    node(100,21)=-0.79689789239031447638957288218324598288952685596429d0
    node(100,22)=-0.7776279096494954756275513868344901065385397999361d0
    node(100,23)=-0.75759811851970717603566796443840077231310897190004d0
    node(100,24)=-0.73682808980202070551242771482010100284327844624712d0
    node(100,25)=-0.7153381175730564464599671227043659640843978385956d0
    node(100,26)=-0.6931491993558019659486479416754372655870000179307d0
    node(100,27)=-0.67028301560314101580258701432322661366980568402882d0
    node(100,28)=-0.6467619085141292798326303044586304350197337842485d0
    node(100,29)=-0.6226088602037077716041908451723122446538177322898d0
    node(100,30)=-0.59784747024717872126480654514934063639489919232049d0
    node(100,31)=-0.57250193262138119131687044352572544896003394967556d0
    node(100,32)=-0.5465970120650941674679942571817499039562417759375d0
    node(100,33)=-0.52015801988176305664681574945520853076893769042009d0
    node(100,34)=-0.49321078920819093356930879344933399099072332535856d0
    node(100,35)=-0.46578164977335804224921662339575458161165111021221d0
    node(100,36)=-0.4378974021720315131089780436221959621257017634841d0
    node(100,37)=-0.4095852916783015425288684000571577014953643891648d0
    node(100,38)=-0.38087298162462995676336254886958740374970726512371d0
    node(100,39)=-0.35178852637242172097234382954897056524931809638907d0
    node(100,40)=-0.3223603439005291517224765823983254274021916230231d0
    node(100,41)=-0.29261718803847196473755588823549438456153898917258d0
    node(100,42)=-0.2625881203715034791689293362549821411320226945355d0
    node(100,43)=-0.23230248184497396964950996320796411069750977150714d0
    node(100,44)=-0.20178986409573599723604885953039646294369200355905d0
    node(100,45)=-0.17108008053860327488753237470708980746585972511807d0
    node(100,46)=-0.14020313723611397320751460468240551661687300626336d0
    node(100,47)=-0.10918920358006111500342600657938488688489962996916d0
    node(100,48)=-0.07806858281343663669481737120155257397635002744853d0
    node(100,49)=-0.04687168242159163161492391293384830953706539908602d0
    node(100,50)=-0.015628984421543082872216699997429340147756182855562d0
    node(100,51)=0.01562898442154308287221669999742934014775618285556d0
    node(100,52)=0.04687168242159163161492391293384830953706539908602d0
    node(100,53)=0.07806858281343663669481737120155257397635002744853d0
    node(100,54)=0.10918920358006111500342600657938488688489962996916d0
    node(100,55)=0.14020313723611397320751460468240551661687300626336d0
    node(100,56)=0.17108008053860327488753237470708980746585972511807d0
    node(100,57)=0.20178986409573599723604885953039646294369200355905d0
    node(100,58)=0.23230248184497396964950996320796411069750977150714d0
    node(100,59)=0.26258812037150347916892933625498214113202269453552d0
    node(100,60)=0.29261718803847196473755588823549438456153898917258d0
    node(100,61)=0.32236034390052915172247658239832542740219162302309d0
    node(100,62)=0.35178852637242172097234382954897056524931809638907d0
    node(100,63)=0.38087298162462995676336254886958740374970726512371d0
    node(100,64)=0.4095852916783015425288684000571577014953643891648d0
    node(100,65)=0.4378974021720315131089780436221959621257017634841d0
    node(100,66)=0.4657816497733580422492166233957545816116511102122d0
    node(100,67)=0.49321078920819093356930879344933399099072332535856d0
    node(100,68)=0.52015801988176305664681574945520853076893769042009d0
    node(100,69)=0.54659701206509416746799425718174990395624177593753d0
    node(100,70)=0.57250193262138119131687044352572544896003394967556d0
    node(100,71)=0.59784747024717872126480654514934063639489919232049d0
    node(100,72)=0.62260886020370777160419084517231224465381773228982d0
    node(100,73)=0.64676190851412927983263030445863043501973378424853d0
    node(100,74)=0.67028301560314101580258701432322661366980568402882d0
    node(100,75)=0.69314919935580196594864794167543726558700001793073d0
    node(100,76)=0.71533811757305644645996712270436596408439783859563d0
    node(100,77)=0.73682808980202070551242771482010100284327844624712d0
    node(100,78)=0.75759811851970717603566796443840077231310897190004d0
    node(100,79)=0.77762790964949547562755138683449010653853979993608d0
    node(100,80)=0.79689789239031447638957288218324598288952685596429d0
    node(100,81)=0.8153892383391762543939887586492580053825503765137d0
    node(100,82)=0.83308387988840082354291583384475567990749483030996d0
    node(100,83)=0.84996452787959128429336259142010465407379077950067d0
    node(100,84)=0.86601468849716462341073996967624296638031483930559d0
    node(100,85)=0.88121867938501841557331682542780558244549441102126d0
    node(100,86)=0.89556164497072698669852102243022776984818176899772d0
    node(100,87)=0.90902957098252969046712633778914606444327728958459d0
    node(100,88)=0.9216092981453339526669513284819874591245827977322d0
    node(100,89)=0.93328853504307954592433366813086250408354607429702d0
    node(100,90)=0.9440558701362559779627747064152187467397203733821d0
    node(100,91)=0.95390078292549174284933693089435764464522145101467d0
    node(100,92)=0.96281365425581552729365932603016638643733150673041d0
    node(100,93)=0.97078577576370633193089785789750538855055719947821d0
    node(100,94)=0.97780935848691828855378108842920192863523449426625d0
    node(100,95)=0.9838775407060570154961001555110081673443670168508d0
    node(100,96)=0.98898439524299174800441874580773663183933363710695d0
    node(100,97)=0.99312493703744345965200989284878347073177145886652d0
    node(100,98)=0.99629513473312514918613173224113103543643128814043d0
    node(100,99)=0.99849195063959581840016335918634916230485485042057d0
    node(100,100)=0.9997137267734412336782284693423006767183495273084d0

    total=1.d0
!繰り返し文
    do i=1,100
    total = w(100,i)*lefunc(opensub(a,b)*node(100,i)+endsub(a,b))
    speed=speed+total
    write(*,*) w(100,i)*lefunc(opensub(a,b)*node(100,i)+endsub(a,b)),speed
    end do

    finaltotal=1.d0
    finaltotal = speed*opensub(a,b)

write(*,*) 'hello',a,b,xx,lefunc(xx),opensub(a,b),endsub(a,b),finaltotal

stop
contains
!関数の計算
function lefunc(x)
implicit none
real(8) :: x,lefunc
lefunc = dsin(x)
end function

function opensub(d,e)
implicit none
real(8) :: d,e,opensub
opensub=(e-d)/2.d0
end function

function endsub(f,g)
implicit none
real(8) :: f,g,endsub
endsub=(f+g)/2.d0
end function

end program main
